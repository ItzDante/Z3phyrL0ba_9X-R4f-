<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Te Amo ‚ù§Ô∏è</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: black;
  overflow: hidden;
  width: 100%;
  height: 100%;
  font-family: Arial, sans-serif;
}

canvas {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
}

/* INTRO */
#intro {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle, #ff7ab8 0%, #c01c5a 80%);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
}

#startBtn {
  font-size: 22px;
  padding: 15px 32px;
  border-radius: 20px;
  border: none;
  background: black;
  color: white;
  cursor: pointer;
  animation: pulse 1.4s infinite;
}

@keyframes pulse {
  0% { transform: scale(1); }
  40% { transform: scale(1.15); }
  100% { transform: scale(1); }
}

/* FADE FINAL */
#fade {
  position: fixed;
  inset: 0;
  background: black;
  opacity: 0;
  pointer-events: none;
  transition: opacity 2s ease;
  z-index: 20;
}
</style>
</head>

<body>

<div id="intro">
  <button id="startBtn">üíñ Abre la sorpresa üíñ</button>
</div>

<div id="fade"></div>

<canvas id="canvas"></canvas>
<canvas id="fireworksCanvas"></canvas>

<script>
// =====================
// MENSAJES (CONFESI√ìN)
// =====================
const messages = [
  "Oye...",
  "hay algo que llevo guardando",
  "desde hace tiempo...",
  "y ya no quiero callarlo",
  "TE AMO",
  "MI LOBA üê∫‚ù§Ô∏è",
  "Y quiero que veas esto..."
];

let currentMessage = 0;
let messageAlpha = 0;
let messageTimer = 0;
let finished = false;

// =====================
// CANVAS PRINCIPAL
// =====================
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let cx, cy, scale;

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  cx = canvas.width / 2;
  cy = canvas.height / 2;
  scale = Math.min(canvas.width, canvas.height) / 40;
}
resize();
addEventListener("resize", resize);

// =====================
// DIBUJAR MENSAJE
// =====================
function drawMessage() {
  if (currentMessage >= messages.length) return;

  ctx.save();
  ctx.globalAlpha = messageAlpha;
  ctx.fillStyle = "white";
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";

  const isFinal = currentMessage >= messages.length - 3;
  ctx.font = isFinal
    ? `bold ${scale * 2}px Arial`
    : `${scale * 1.2}px Arial`;

  ctx.shadowColor = "hotpink";
  ctx.shadowBlur = isFinal ? 25 : 10;

  ctx.fillText(messages[currentMessage], cx, cy + scale * 3);
  ctx.restore();

  messageAlpha += 0.02;
  messageTimer++;

  if (messageTimer > 140) {
    messageAlpha = 0;
    messageTimer = 0;
    currentMessage++;

    if (currentMessage >= messages.length && !finished) {
      finished = true;
      endScene();
    }
  }
}

// =====================
// CORAZ√ìN
// =====================
function heartPoint(t) {
  return {
    x: scale * 16 * Math.pow(Math.sin(t), 3),
    y: -scale * (
      13 * Math.cos(t) -
      5 * Math.cos(2 * t) -
      2 * Math.cos(3 * t) -
      Math.cos(4 * t)
    )
  };
}

let t = 0;
let heartPoints = [];
let phase = "heart";

// =====================
// FUEGOS ARTIFICIALES
// =====================
const fwCanvas = document.getElementById("fireworksCanvas");
const fwCtx = fwCanvas.getContext("2d");
fwCanvas.width = innerWidth;
fwCanvas.height = innerHeight;

let fireworks = [];

function createFirework() {
  const x = Math.random() * fwCanvas.width;
  const y = Math.random() * fwCanvas.height * 0.5;

  for (let i = 0; i < 35; i++) {
    fireworks.push({
      x, y,
      a: Math.random() * Math.PI * 2,
      s: Math.random() * 2 + 1,
      r: Math.random() * 3 + 2,
      life: 1
    });
  }
}

function drawFireworks() {
  fwCtx.clearRect(0, 0, fwCanvas.width, fwCanvas.height);
  fireworks = fireworks.filter(f => f.life > 0);

  fireworks.forEach(f => {
    f.x += Math.cos(f.a) * f.s;
    f.y += Math.sin(f.a) * f.s;
    f.life -= 0.02;

    fwCtx.globalAlpha = f.life;
    fwCtx.fillStyle = "hotpink";
    fwCtx.beginPath();
    fwCtx.arc(f.x, f.y, f.r, 0, Math.PI * 2);
    fwCtx.fill();
  });

  requestAnimationFrame(drawFireworks);
}
drawFireworks();

// =====================
// LOOP PRINCIPAL
// =====================
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.save();
  ctx.translate(cx, cy);

  if (phase === "heart") {
    const p = heartPoint(t);
    heartPoints.push(p);

    ctx.strokeStyle = "hotpink";
    ctx.lineWidth = 2;
    ctx.beginPath();
    heartPoints.forEach((pt, i) => {
      if (i === 0) ctx.moveTo(pt.x, pt.y);
      else ctx.lineTo(pt.x, pt.y);
    });
    ctx.stroke();

    t += 0.03;
    if (t > Math.PI * 2) phase = "message";
  }

  ctx.restore();

  if (phase === "message") {
    drawMessage();
    if (Math.random() < 0.05) createFirework();
  }

  requestAnimationFrame(draw);
}

// =====================
// FINAL ‚Üí TRANSICI√ìN
// =====================
function endScene() {
  setTimeout(() => {
    document.getElementById("fade").style.opacity = 1;
  }, 1800);

  setTimeout(() => {
    // üëâ aqu√≠ enlazas la galaxia
    window.location.href = "Galaxia-del-Amor.html";
  }, 4200);
}

// =====================
// START
// =====================
document.getElementById("startBtn").onclick = () => {
  document.getElementById("intro").style.display = "none";
  draw();
};
</script>

</body>
</html>
